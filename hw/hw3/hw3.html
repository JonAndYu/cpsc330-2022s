
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CPSC 330 - Applied Machine Learning &#8212; CPSC 330 Applied Machine Learning</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/UBC-CS-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CPSC 330 Applied Machine Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Things you should know
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../docs/README.html">
   CPSC 330 Documents
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/01_intro.html">
   Lecture 1: Course Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/02_decision-trees.html">
   Lecture 2: Terminology, Baselines, Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/03_ml-fundamentals.html">
   Lecture 3: Machine Learning Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/04_kNNs-SVM-RBF.html">
   Lecture 4:
   <span class="math notranslate nohighlight">
    \(k\)
   </span>
   -Nearest Neighbours and SVM RBFs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/05_preprocessing-pipelines.html">
   Lecture 5: Preprocessing and
   <code class="docutils literal notranslate">
    <span class="pre">
     sklearn
    </span>
   </code>
   pipelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/06_column-transformer-text-feats.html">
   Lecture 6:
   <code class="docutils literal notranslate">
    <span class="pre">
     sklearn
    </span>
   </code>
   <code class="docutils literal notranslate">
    <span class="pre">
     ColumnTransformer
    </span>
   </code>
   and Text Features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/07_linear-models.html">
   Lecture 7: Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lectures/08_hyperparameter-optimization.html">
   Lecture 8: Hyperparameter Optimization and Optimization Bias
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Attribution
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../attribution.html">
   Attributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../LICENSE.html">
   LICENSE
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Varada Kolhatkar, CPSC 330 2021-22<br>Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/hw/hw3/hw3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/UBC-CS/cpsc330/master?urlpath=tree/hw/hw3/hw3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#homework-3-preprocessing">
   Homework 3: Preprocessing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#associated-lectures-lectures-4-5-6">
     Associated lectures: Lectures 4, 5, 6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instructions-a-name-si-a">
   Instructions
   <a name="si">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-name-in-a">
   Introduction
   <a name="in">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-1-introducing-the-dataset-a-name-1-a">
   Exercise 1: Introducing the dataset
   <a name="1">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-splitting">
     1.1 Data splitting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-2-exploratory-data-analysis-eda-a-name-2-a">
   Exercise 2: Exploratory data analysis (EDA)
   <a name="2">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing-features">
     2.1 Visualizing features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-transformations-to-apply">
     2.2 Identify transformations to apply
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#separating-feature-vectors-and-targets">
     2.3 Separating feature vectors and targets
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-3-preprocessing-a-name-3-a">
   Exercise 3: Preprocessing
   <a name="3">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preprocessing-using-sklearn-s-columntransformer-and-pipeline">
     3.1 Preprocessing using
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn
      </span>
     </code>
     ’s
     <code class="docutils literal notranslate">
      <span class="pre">
       ColumnTransformer
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       Pipeline
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-4-building-models-a-name-4-a">
   Exercise 4: Building models
   <a name="4">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baseline-model">
     4.1 Baseline model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trying-different-classifiers">
     4.2 Trying different classifiers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-4-3-exploring-importance-of-scaling">
     (optional) 4.3 Exploring importance of scaling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hyperparameter-optimization">
     4.4 Hyperparameter optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-5-evaluating-on-the-test-set-a-name-5-a">
   Exercise 5: Evaluating on the test set
   <a name="5">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scoring-on-the-unseen-test-set">
     5.1 Scoring on the unseen test set
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submission-instructions">
   Submission instructions
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="cpsc-330-applied-machine-learning">
<h1>CPSC 330 - Applied Machine Learning<a class="headerlink" href="#cpsc-330-applied-machine-learning" title="Permalink to this headline">¶</a></h1>
<div class="section" id="homework-3-preprocessing">
<h2>Homework 3: Preprocessing<a class="headerlink" href="#homework-3-preprocessing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="associated-lectures-lectures-4-5-6">
<h3>Associated lectures: <a class="reference external" href="https://ubc-cs.github.io/cpsc330/README.html">Lectures 4, 5, 6</a><a class="headerlink" href="#associated-lectures-lectures-4-5-6" title="Permalink to this headline">¶</a></h3>
<p><strong>Due date: Monday, Oct 04, 2021 at 11:59pm</strong></p>
</div>
</div>
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#si">Instructions</a></p></li>
<li><p><a class="reference external" href="#in">Introduction</a></p></li>
<li><p><a class="reference external" href="#1">Exercise 1: Introducing the dataset</a></p></li>
<li><p><a class="reference external" href="#2">Exercise 2: Exploratory data analysis (EDA)</a></p></li>
<li><p><a class="reference external" href="#3">Exercise 3: Preprocessing</a></p></li>
<li><p><a class="reference external" href="#4">Exercise 4: Building models</a></p></li>
<li><p><a class="reference external" href="#5">Exercise 5: Evaluating on the test set</a></p></li>
</ul>
</div>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span><span class="p">,</span> <span class="n">make_column_transformer</span>
<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">cross_validate</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span><span class="p">,</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="instructions-a-name-si-a">
<h2>Instructions <a name="si"></a><a class="headerlink" href="#instructions-a-name-si-a" title="Permalink to this headline">¶</a></h2>
<hr>
rubric={points:6}
<p>Follow the <a class="reference external" href="https://github.com/UBC-CS/cpsc330/blob/master/docs/homework_instructions.md">homework submission instructions</a>.</p>
<p><strong>You may work with a partner on this homework and submit your assignment as a group.</strong> Below are some instructions on working as a group.</p>
<ul class="simple">
<li><p>The maximum group size is 2.</p></li>
<li><p>Use group work as an opportunity to collaborate and learn new things from each other.</p></li>
<li><p>Be respectful to each other and make sure you understand all the concepts in the assignment well.</p></li>
<li><p>It’s your responsibility to make sure that the assignment is submitted by one of the group members before the deadline.</p></li>
<li><p>You can find the instructions on how to do group submission on Gradescope <a class="reference external" href="https://help.gradescope.com/article/m5qz2xsnjy-student-add-group-members">here</a>.</p></li>
</ul>
<p><em>Note: The assignments will get gradually more open-ended as we progress through the course. In many cases, there won’t be a single correct solution. Sometimes you will have to make your own choices and your own decisions (for example, on what parameter values to use when they are not explicitly provided in the instructions). Use your own judgment in such cases and justify your choices, if necessary.</em></p>
</div>
<div class="section" id="introduction-a-name-in-a">
<h2>Introduction <a name="in"></a><a class="headerlink" href="#introduction-a-name-in-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>A crucial step when using machine learning algorithms on real-world datasets is preprocessing. This homework will give you some practice of data preprocessing and building a supervised machine learning pipeline on a real-world dataset.</p>
<p><br><br></p>
</div>
<div class="section" id="exercise-1-introducing-the-dataset-a-name-1-a">
<h2>Exercise 1: Introducing the dataset <a name="1"></a><a class="headerlink" href="#exercise-1-introducing-the-dataset-a-name-1-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>In this lab, you will be working on <a class="reference external" href="https://www.kaggle.com/uciml/adult-census-income">the adult census dataset</a>. Download the CSV and save it as <code class="docutils literal notranslate"><span class="pre">adult.csv</span></code> locally in this homework folder.</p>
<p>This is a classification dataset and the classification task is to predict whether income exceeds 50K per year or not based on the census data. You can find more information on the dataset and features <a class="reference external" href="http://archive.ics.uci.edu/ml/datasets/Adult">here</a>.</p>
<p>The starter code below loads the data CSV (assuming that it is saved as <code class="docutils literal notranslate"><span class="pre">adult.csv</span></code> in this folder).</p>
<p><em>Note that many popular datasets have sex as a feature where the possible values are male and female. This representation reflects how the data were collected and is not meant to imply that, for example, gender is binary.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">census_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;adult.csv&quot;</span><span class="p">)</span>
<span class="n">census_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">80</span><span class="o">/</span><span class="n">kr9rkqfj4w78h49djkz8yy9r0000gp</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_5750</span><span class="o">/</span><span class="mf">1222059788.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">census_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;adult.csv&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">census_df</span><span class="o">.</span><span class="n">shape</span>

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/util/_decorators.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>                     <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>                 <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">311</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span> 
<span class="g g-Whitespace">    </span><span class="mi">313</span>         <span class="k">return</span> <span class="n">wrapper</span>

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span> 
<span class="ne">--&gt; </span><span class="mi">586</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> 
<span class="g g-Whitespace">    </span><span class="mi">588</span> 

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">480</span> 
<span class="g g-Whitespace">    </span><span class="mi">481</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">482</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span> 
<span class="g g-Whitespace">    </span><span class="mi">484</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">809</span>             <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span> 
<span class="ne">--&gt; </span><span class="mi">811</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span> 
<span class="g g-Whitespace">    </span><span class="mi">813</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1038</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1039</span>         <span class="c1"># error: Too many arguments for &quot;ParserBase&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1040</span>         <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span> 
<span class="g g-Whitespace">   </span><span class="mi">1042</span>     <span class="k">def</span> <span class="nf">_failover_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/parsers/c_parser_wrapper.py</span> in <span class="ni">__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span> 
<span class="g g-Whitespace">     </span><span class="mi">50</span>         <span class="c1"># open handles</span>
<span class="ne">---&gt; </span><span class="mi">51</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_open_handles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span>         <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> 

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/parsers/base_parser.py</span> in <span class="ni">_open_handles</span><span class="nt">(self, src, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>         <span class="n">Let</span> <span class="n">the</span> <span class="n">readers</span> <span class="nb">open</span> <span class="n">IOHandles</span> <span class="n">after</span> <span class="n">they</span> <span class="n">are</span> <span class="n">done</span> <span class="k">with</span> <span class="n">their</span> <span class="n">potential</span> <span class="n">raises</span><span class="o">.</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">222</span><span class="s2">         self.handles = get_handle(</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span><span class="s2">             src,</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span><span class="s2">             &quot;r&quot;,</span>

<span class="nn">~/opt/miniconda3/envs/cpsc330/lib/python3.9/site-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span><span class="s2">         if ioargs.encoding and &quot;b&quot; not in ioargs.mode:</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span><span class="s2">             # Encoding</span>
<span class="ne">--&gt; </span><span class="mi">701</span><span class="s2">             handle = open(</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span><span class="s2">                 handle,</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span><span class="s2">                 ioargs.mode,</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;adult.csv&#39;
</pre></div>
</div>
</div>
</div>
<p><br><br></p>
<div class="section" id="data-splitting">
<h3>1.1 Data splitting<a class="headerlink" href="#data-splitting" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:4}</p>
<p>In order to avoid violation of the golden rule, the first step before we do anything is splitting the data.</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Split the data into <code class="docutils literal notranslate"><span class="pre">train_df</span></code> (60%) and <code class="docutils literal notranslate"><span class="pre">test_df</span></code> (40%) with <code class="docutils literal notranslate"><span class="pre">random_state</span> <span class="pre">=</span> <span class="pre">42</span></code>. Keep the target column (<code class="docutils literal notranslate"><span class="pre">income</span></code>) in the splits so that we can use it in the exploratory data analysis.</p></li>
</ol>
<p><em>Usually having more data for training is a good idea. But here I’m using 60%/40% split because this is kind of a big dataset for a modest laptop. A smaller training data means it won’t take too long to train the model on your laptop. A side advantage of this would be that with a bigger test split, we’ll have a more reliable estimate of the deployment performance!</em></p>
<p><br><br></p>
</div>
</div>
<div class="section" id="exercise-2-exploratory-data-analysis-eda-a-name-2-a">
<h2>Exercise 2: Exploratory data analysis (EDA) <a name="2"></a><a class="headerlink" href="#exercise-2-exploratory-data-analysis-eda-a-name-2-a" title="Permalink to this headline">¶</a></h2>
<hr><p>Let’s examine our <code class="docutils literal notranslate"><span class="pre">train_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We see some missing values represented with a “?”. Probably these were the questions not answered by some people during the census.  Usually <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> or <code class="docutils literal notranslate"><span class="pre">.info()</span></code> methods would give you information on missing values. But here, they won’t pick “?” as missing values as they are encoded as strings instead of an actual NaN in Python. So let’s replace them with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> before we carry out EDA. If you do not do it, you’ll encounter an error later on when you try to pass this data to a classifier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df_nan</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">test_df_nan</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">train_df_nan</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df_nan</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The “?” symbols are now replaced with NaN values.</p>
<p><br><br></p>
<div class="section" id="visualizing-features">
<h3>2.1 Visualizing features<a class="headerlink" href="#visualizing-features" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:10}</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Examine the information given by <code class="docutils literal notranslate"><span class="pre">train_df_nan.info()</span></code> and <code class="docutils literal notranslate"><span class="pre">train_df_nan.describe()</span></code> methods. In case of <code class="docutils literal notranslate"><span class="pre">.describe()</span></code>, use the <code class="docutils literal notranslate"><span class="pre">include=&quot;all&quot;</span></code> argument to show summary statistics of all  features.</p></li>
<li><p>Visualize the histograms of numeric features.</p></li>
<li><p>From the visualizations, which features seem relevant for the given prediction task?</p></li>
</ol>
<blockquote>
<div><p>Note: (Optional) If you’re feeling excited about this you are welcome to use <a class="reference external" href="https://github.com/pandas-profiling/pandas-profiling"><code class="docutils literal notranslate"><span class="pre">pandas_profiling</span></code></a> for more elaborate visualization and EDA.</p>
</div></blockquote>
<p><br><br></p>
</div>
<div class="section" id="identify-transformations-to-apply">
<h3>2.2 Identify transformations to apply<a class="headerlink" href="#identify-transformations-to-apply" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:18}</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Identify the sequence of transformations that you would apply on each column in the dataset and fill in the table below accordingly. An example of the sequence of transformations to be applied on the <code class="docutils literal notranslate"><span class="pre">occupation</span></code> feature is shown in the table below. You may decide not to apply any transformations on a certain column or entirely drop a column from your model. That’s totally fine.</p></li>
<li><p>Are there common transformations you would like to apply on certain types of features? Identify different feature types for applying different transformations. In particular, fill in the lists below.</p></li>
<li><p>Is including the <code class="docutils literal notranslate"><span class="pre">race</span></code> feature for predicting income ethically a good idea? Briefly discuss.</p></li>
</ol>
<blockquote>
<div><p>Note: This question is a bit open-ended and there is no single correct solution.</p>
</div></blockquote>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Transformation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>occupation</p></td>
<td><p>imputation, OHE</p></td>
</tr>
<tr class="row-odd"><td><p>age</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>workclass</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>fnlwgt</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>education</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>education.num</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>marital.status</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>relationship</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>race</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>sex</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>capital.gain</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>capital.loss</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>hours.per.week</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>native.country</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill in the lists below. </span>
<span class="c1"># It&#39;s OK to keep some of the lists empty or add new lists. </span>
<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ordinal_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">binary_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">drop_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">passthrough_features</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;income&quot;</span>
</pre></div>
</div>
</div>
</div>
<p><br><br></p>
</div>
<div class="section" id="separating-feature-vectors-and-targets">
<h3>2.3 Separating feature vectors and targets<a class="headerlink" href="#separating-feature-vectors-and-targets" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:4}</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Create <code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>, <code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code> from <code class="docutils literal notranslate"><span class="pre">train_df_nan</span></code> and <code class="docutils literal notranslate"><span class="pre">test_df_nan</span></code>.</p></li>
<li><p>At this point, if you train <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html"><code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">SVC</span></code></a> model on <code class="docutils literal notranslate"><span class="pre">X_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_train</span></code> would it work? Why or why not?</p></li>
</ol>
<p><br><br><br><br></p>
</div>
</div>
<div class="section" id="exercise-3-preprocessing-a-name-3-a">
<h2>Exercise 3: Preprocessing <a name="3"></a><a class="headerlink" href="#exercise-3-preprocessing-a-name-3-a" title="Permalink to this headline">¶</a></h2>
<hr><div class="section" id="preprocessing-using-sklearn-s-columntransformer-and-pipeline">
<h3>3.1 Preprocessing using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> and <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code><a class="headerlink" href="#preprocessing-using-sklearn-s-columntransformer-and-pipeline" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:18}</p>
<p>Let’s carry out preprocessing using <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code> and <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code>. Note that you can define pipelines in two ways:</p>
<ul class="simple">
<li><p>by using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"><code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a> and explicitly providing named steps</p></li>
<li><p>by using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html#sklearn.pipeline.make_pipeline"><code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code></a>, which automatically names the steps in the pipeline with their class names.</p></li>
</ul>
<p>Similarly you can create a column transformer in two ways:</p>
<ul class="simple">
<li><p>by using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html"><code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code></a></p></li>
<li><p>by using <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.make_column_transformer.html"><code class="docutils literal notranslate"><span class="pre">make_column_transformer</span></code></a></p></li>
</ul>
<p>You may use the method of your choice but <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code> and <code class="docutils literal notranslate"><span class="pre">make_column_transformer</span></code> are highly recommended.</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Create a column transformer <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> based on transformations you want to apply on the data from 2.2.</p></li>
<li><p>Transform the data by calling <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code> on the training set. What’s the shape of the transformed data?</p></li>
<li><p>Why do we need to use a column transformer in this case? Briefly explain.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessor</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<p><br><br><br><br></p>
</div>
</div>
<div class="section" id="exercise-4-building-models-a-name-4-a">
<h2>Exercise 4: Building models <a name="4"></a><a class="headerlink" href="#exercise-4-building-models-a-name-4-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>Now that we have preprocessed features, we are ready to build models. Below, I’m providing the function we used in class which returns mean cross-validation score along with standard deviation for a given model. Feel free to use it to keep track of your results if you like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># dictionary to store all the results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_std_cross_val_scores</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns mean and std of cross validation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model :</span>
<span class="sd">        scikit-learn model</span>
<span class="sd">    X_train : numpy array or pandas DataFrame</span>
<span class="sd">        X in the training data</span>
<span class="sd">    y_train :</span>
<span class="sd">        y in the training data</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">        pandas Series with mean scores from cross_validation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">mean_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">out_col</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean_scores</span><span class="p">)):</span>
        <span class="n">out_col</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;%0.3f (+/- %0.3f)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean_scores</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std_scores</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">out_col</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">mean_scores</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><br><br></p>
<div class="section" id="baseline-model">
<h3>4.1 Baseline model<a class="headerlink" href="#baseline-model" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:6}</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Define a pipeline with two steps: <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> from 3.1 and <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>’s <code class="docutils literal notranslate"><span class="pre">DummyClassifier</span></code> with <code class="docutils literal notranslate"><span class="pre">strategy=&quot;prior&quot;</span></code> as your classifier.</p></li>
<li><p>Carry out 5-fold cross-validation with the pipeline. Store the results in <code class="docutils literal notranslate"><span class="pre">results_dict</span></code> above. Display the results as a pandas DataFrame.</p></li>
</ol>
<blockquote>
<div><p>You may use the function <code class="docutils literal notranslate"><span class="pre">mean_std_cross_val_scores</span></code> above to carry out cross-validation and storing results. Refer to the class notes if you are unsure about how to use it.</p>
</div></blockquote>
<p><br><br></p>
</div>
<div class="section" id="trying-different-classifiers">
<h3>4.2 Trying different classifiers<a class="headerlink" href="#trying-different-classifiers" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:14}</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>For each of the models in the starter code below:</p>
<ul class="simple">
<li><p>Define a pipeline with two steps: <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> from 3.1 and the model as your classifier.</p></li>
<li><p>Carry out 5-fold cross-validation with the pipeline.</p></li>
<li><p>Store the results in <code class="docutils literal notranslate"><span class="pre">results_dict</span></code>.</p></li>
</ul>
</li>
<li><p>Display all the results so far as a pandas dataframe.</p></li>
<li><p>Compare the train and validation accuracies and <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">score</span></code> times in each case. How do the the validation accuracies compare to the baseline model from 4.1? Which model has the best validation accuracy? Which model is the fastest one?</p></li>
</ol>
<blockquote>
<div><p>Note that this might take a while to run.</p>
</div></blockquote>
<blockquote>
<div><p>You may use the function above <code class="docutils literal notranslate"><span class="pre">mean_std_cross_val_scores</span></code> to carry out cross-validation and storing results. Refer to the class notes if you are unsure about how to use it.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;decision tree&quot;</span><span class="p">:</span> <span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
    <span class="s2">&quot;kNN&quot;</span><span class="p">:</span> <span class="n">KNeighborsClassifier</span><span class="p">(),</span>
    <span class="s2">&quot;RBF SVM&quot;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><br><br></p>
</div>
<div class="section" id="optional-4-3-exploring-importance-of-scaling">
<h3>(optional) 4.3 Exploring importance of scaling<a class="headerlink" href="#optional-4-3-exploring-importance-of-scaling" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:1}</p>
<p>In this exercise you’ll examine whether scaling helps in case of KNNs and SVM RBFs.</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Create a column transformer without the <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> step for <code class="docutils literal notranslate"><span class="pre">numeric_features</span></code>.</p></li>
<li><p>Repeat the steps in 4.2 with this new column transformer.</p></li>
<li><p>Compare the results of scaled numeric features with unscaled numeric features. Is scaling necessary for decision trees? Why or why not?</p></li>
</ol>
</div>
<div class="section" id="hyperparameter-optimization">
<h3>4.4 Hyperparameter optimization<a class="headerlink" href="#hyperparameter-optimization" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:10}</p>
<p>In this exercise, you’ll carry out hyperparameter optimization for the hyperparameter <code class="docutils literal notranslate"><span class="pre">C</span></code> of SVC RBF classifier. In practice you’ll carry out hyperparameter optimization for all different hyperparameters for the most promising classifiers. For the purpose of this assignment, we’ll only do it for the <code class="docutils literal notranslate"><span class="pre">SVC</span></code> classifier with one hyperparameter: <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>For each <code class="docutils literal notranslate"><span class="pre">C</span></code> value in the <code class="docutils literal notranslate"><span class="pre">param_grid</span></code> in the starter code below:</p>
<ul class="simple">
<li><p>Create a pipeline object with two steps: preprocessor from 3.1 and <code class="docutils literal notranslate"><span class="pre">SVC</span></code> classifier with the value of <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></li>
<li><p>Carry out 5-fold cross validation with the pipeline.</p></li>
<li><p>Store the results in <code class="docutils literal notranslate"><span class="pre">results_dict</span></code> and display results as a pandas DataFrame.</p></li>
</ul>
</li>
<li><p>Which hyperparameter value seems to be performing the best? Is it different than the default value for the hyperparameter used by <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>?</p></li>
</ol>
<blockquote>
<div><p>Note: Running this might take a while.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<p><br><br><br><br></p>
</div>
</div>
<div class="section" id="exercise-5-evaluating-on-the-test-set-a-name-5-a">
<h2>Exercise 5: Evaluating on the test set <a name="5"></a><a class="headerlink" href="#exercise-5-evaluating-on-the-test-set-a-name-5-a" title="Permalink to this headline">¶</a></h2>
<hr>
<p>Now that we have a best performing model, it’s time to assess our model on the set aside test set. In this exercise you’ll examine whether the results you obtained using cross-validation on the train set are consistent with the results on the test set.</p>
<div class="section" id="scoring-on-the-unseen-test-set">
<h3>5.1 Scoring on the unseen test set<a class="headerlink" href="#scoring-on-the-unseen-test-set" title="Permalink to this headline">¶</a></h3>
<p>rubric={points:10}</p>
<p><strong>Your tasks:</strong></p>
<ol class="simple">
<li><p>Train the best performing model on the entire training set.</p></li>
<li><p>Report the results of this model on <code class="docutils literal notranslate"><span class="pre">X_test</span></code>.</p></li>
<li><p>Are the cross-validation results and test results consistent?</p></li>
</ol>
<p><br><br><br><br></p>
</div>
</div>
<div class="section" id="submission-instructions">
<h2>Submission instructions<a class="headerlink" href="#submission-instructions" title="Permalink to this headline">¶</a></h2>
<p><strong>PLEASE READ:</strong> When you are ready to submit your assignment do the following:</p>
<ol class="simple">
<li><p>Run all cells in your notebook to make sure there are no errors by doing <code class="docutils literal notranslate"><span class="pre">Kernel</span> <span class="pre">-&gt;</span> <span class="pre">Restart</span> <span class="pre">Kernel</span> <span class="pre">and</span> <span class="pre">Clear</span> <span class="pre">All</span> <span class="pre">Outputs</span></code> and then <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">-&gt;</span> <span class="pre">Run</span> <span class="pre">All</span> <span class="pre">Cells</span></code>.</p></li>
<li><p>Notebooks with cell execution numbers out of order or not starting from “1” will have marks deducted. Notebooks without the output displayed may not be graded at all (because we need to see the output in order to grade your work).</p></li>
<li><p>Upload the assignment using Gradescope’s drag and drop tool. Check out this <a class="reference external" href="https://lthub.ubc.ca/guides/gradescope-student-guide/">Gradescope Student Guide</a> if you need help with Gradescope submission.</p></li>
</ol>
<p>Congratulations on finishing the homework! This was a tricky one but I hope you are feeling good after working on it. You are now ready to build a simple supervised machine learning pipeline on real-world datasets! Well done :clap:!</p>
<p><img alt="" src="../../_images/eva-well-done.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-cpsc330-py"
        },
        kernelOptions: {
            kernelName: "conda-env-cpsc330-py",
            path: "./hw/hw3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-cpsc330-py'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Varada Kolhatkar<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>